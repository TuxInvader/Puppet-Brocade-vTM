# === Class: brocadevtm::global_settings
#

class brocadevtm::global_settings (
  $ensure = present,
  $basic__accepting_delay                      = 50,
  $basic__afm_enabled                          = false,
  $basic__chunk_size                           = 16384,
  $basic__client_first_opt                     = false,
  $basic__max_fds                              = 1048576,
  $basic__monitor_memory_size                  = 4096,
  $basic__rate_class_limit                     = 25000,
  $basic__shared_pool_size                     = "10MB",
  $basic__slm_class_limit                      = 1024,
  $basic__so_rbuff_size                        = 0,
  $basic__so_wbuff_size                        = 0,
  $basic__socket_optimizations                 = "auto",
  $basic__tip_class_limit                      = 10000,
  $admin__honor_fallback_scsv                  = true,
  $admin__ssl3_allow_rehandshake               = "rfc5746",
  $admin__ssl3_ciphers                         = "SSL_RSA_WITH_AES_128_GCM_SHA256,SSL_RSA_WITH_AES_128_CBC_SHA256,SSL_RSA_WITH_AES_128_CBC_SHA,SSL_RSA_WITH_AES_256_GCM_SHA384,SSL_RSA_WITH_AES_256_CBC_SHA256,SSL_RSA_WITH_AES_256_CBC_SHA,SSL_RSA_WITH_3DES_EDE_CBC_SHA",
  $admin__ssl3_diffie_hellman_key_length       = "dh_2048",
  $admin__ssl3_min_rehandshake_interval        = 1000,
  $admin__ssl_insert_extra_fragment            = false,
  $admin__ssl_max_handshake_message_size       = 10240,
  $admin__ssl_prevent_timing_side_channels     = false,
  $admin__ssl_signature_algorithms             = "",
  $admin__support_ssl2                         = false,
  $admin__support_ssl3                         = false,
  $admin__support_tls1                         = true,
  $admin__support_tls11                        = true,
  $admin__support_tls12                        = true,
  $appliance__bootloader_password              = "",
  $appliance__manage_ncipher                   = true,
  $appliance__nethsm_esn                       = "",
  $appliance__nethsm_hash                      = "",
  $appliance__nethsm_ip                        = "",
  $appliance__nethsm_ncipher_rfs               = "",
  $appliance__return_path_routing_enabled      = false,
  $aptimizer__max_dependent_fetch_size         = "2MB",
  $aptimizer__max_original_content_buffer_size = "2MB",
  $aptimizer__watchdog_interval                = 300,
  $aptimizer__watchdog_limit                   = 3,
  $autoscaler__verbose                         = false,
  $cluster_comms__allow_update_default         = true,
  $cluster_comms__allowed_update_hosts         = ["127.0.0.1"],
  $cluster_comms__state_sync_interval          = 3,
  $cluster_comms__state_sync_timeout           = 6,
  $connection__idle_connections_max            = 0,
  $connection__idle_timeout                    = 10,
  $connection__listen_queue_size               = 0,
  $connection__max_accepting                   = 0,
  $connection__multiple_accept                 = false,
  $dns__max_ttl                                = 86400,
  $dns__min_ttl                                = 86400,
  $dns__negative_expiry                        = 60,
  $dns__size                                   = 10867,
  $dns__timeout                                = 12,
  $ec2__access_key_id                          = "",
  $ec2__secret_access_key                      = "",
  $ec2__verify_query_server_cert               = false,
  $eventing__mail_interval                     = 30,
  $eventing__max_attempts                      = 10,
  $fault_tolerance__arp_count                  = 10,
  $fault_tolerance__auto_failback              = true,
  $fault_tolerance__frontend_check_ips         = ["%gateway%"],
  $fault_tolerance__heartbeat_method           = "unicast",
  $fault_tolerance__igmp_interval              = 30,
  $fault_tolerance__monitor_interval           = 500,
  $fault_tolerance__monitor_timeout            = 5,
  $fault_tolerance__multicast_address          = "239.100.1.1:9090",
  $fault_tolerance__unicast_port               = 9090,
  $fault_tolerance__use_bind_ip                = false,
  $fault_tolerance__verbose                    = false,
  $fips__enabled                               = false,
  $ftp__data_bind_low                          = false,
  $glb__verbose                                = false,
  $historical_activity__keep_days              = 90,
  $ip__appliance_returnpath                    = [],
  $java__classpath                             = "",
  $java__command                               = "java -server",
  $java__enabled                               = false,
  $java__lib                                   = "",
  $java__max_connections                       = 256,
  $java__session_age                           = 86400,
  $kerberos__verbose                           = false,
  $log__error_level                            = "info",
  $log__flush_time                             = 5,
  $log__log_file                               = "%zeushome%/zxtm/log/errors",
  $log__rate                                   = 50,
  $log__reopen                                 = 30,
  $log__time                                   = 60,
  $ospfv2__area                                = "0.0.0.1",
  $ospfv2__area_type                           = "normal",
  $ospfv2__authentication_key_id_a             = 0,
  $ospfv2__authentication_key_id_b             = 0,
  $ospfv2__authentication_shared_secret_a      = "",
  $ospfv2__authentication_shared_secret_b      = "",
  $ospfv2__enabled                             = false,
  $ospfv2__hello_interval                      = 10,
  $ospfv2__router_dead_interval                = 40,
  $protection__conncount_size                  = "20MB",
  $recent_connections__max_per_process         = 500,
  $recent_connections__retain_time             = 60,
  $recent_connections__snapshot_size           = 500,
  $rest_api__auth_timeout                      = 120,
  $rest_api__enabled                           = true,
  $rest_api__http_max_header_length            = 4096,
  $rest_api__replicate_absolute                = 20,
  $rest_api__replicate_lull                    = 5,
  $rest_api__replicate_timeout                 = 10,
  $security__login_banner                      = "",
  $security__login_banner_accept               = false,
  $security__login_delay                       = 0,
  $security__max_login_attempts                = 0,
  $security__max_login_external                = false,
  $security__max_login_suspension_time         = 15,
  $security__password_allow_consecutive_chars  = true,
  $security__password_changes_per_day          = 0,
  $security__password_min_alpha_chars          = 0,
  $security__password_min_length               = 0,
  $security__password_min_numeric_chars        = 0,
  $security__password_min_special_chars        = 0,
  $security__password_min_uppercase_chars      = 0,
  $security__password_reuse_after              = 0,
  $security__post_login_banner                 = "",
  $security__track_unknown_users               = false,
  $security__ui_page_banner                    = "",
  $session__asp_cache_size                     = 32768,
  $session__ip_cache_size                      = 32768,
  $session__j2ee_cache_size                    = 32768,
  $session__ssl_cache_size                     = 32768,
  $session__universal_cache_size               = 32768,
  $snmp__user_counters                         = 10,
  $soap__idle_minutes                          = 10,
  $ssl__cache_expiry                           = 1800,
  $ssl__cache_per_virtualserver                = true,
  $ssl__cache_size                             = 6151,
  $ssl__crl_mem_size                           = "5MB",
  $ssl__honor_fallback_scsv                    = true,
  $ssl__insert_extra_fragment                  = false,
  $ssl__max_handshake_message_size             = 10240,
  $ssl__ocsp_cache_size                        = 2048,
  $ssl__ocsp_stapling_default_refresh_interval = 60,
  $ssl__ocsp_stapling_maximum_refresh_interval = 864000,
  $ssl__ocsp_stapling_mem_size                 = "1MB",
  $ssl__ocsp_stapling_time_tolerance           = 30,
  $ssl__ocsp_stapling_verify_response          = false,
  $ssl__prevent_timing_side_channels           = false,
  $ssl__signature_algorithms                   = "",
  $ssl__ssl3_allow_rehandshake                 = "safe",
  $ssl__ssl3_ciphers                           = "",
  $ssl__ssl3_diffie_hellman_key_length         = "dh_1024",
  $ssl__ssl3_min_rehandshake_interval          = 1000,
  $ssl__support_ssl2                           = false,
  $ssl__support_ssl3                           = false,
  $ssl__support_tls1                           = true,
  $ssl__support_tls1_1                         = true,
  $ssl__support_tls1_2                         = true,
  $ssl_hardware__accel                         = false,
  $ssl_hardware__driver_pkcs11_debug           = false,
  $ssl_hardware__driver_pkcs11_lib             = "",
  $ssl_hardware__driver_pkcs11_slot_desc       = "",
  $ssl_hardware__driver_pkcs11_slot_type       = "operator",
  $ssl_hardware__driver_pkcs11_user_pin        = "",
  $ssl_hardware__failure_count                 = 5,
  $ssl_hardware__library                       = "none",
  $trafficscript__array_elements               = 100000,
  $trafficscript__data_local_size              = "5%",
  $trafficscript__data_size                    = "5%",
  $trafficscript__execution_time_warning       = 500,
  $trafficscript__max_instr                    = 100000,
  $trafficscript__memory_warning               = 1048576,
  $trafficscript__regex_cache_size             = 57,
  $trafficscript__regex_match_limit            = 10000000,
  $trafficscript__regex_match_warn_percentage  = 5,
  $trafficscript__variable_pool_use            = false,
  $web_cache__avg_path_length                  = 512,
  $web_cache__disk                             = false,
  $web_cache__disk_dir                         = "%zeushome%/zxtm/internal",
  $web_cache__max_file_num                     = 10000,
  $web_cache__max_file_size                    = "2%",
  $web_cache__max_path_length                  = 2048,
  $web_cache__normalize_query                  = true,
  $web_cache__size                             = "20%",
  $web_cache__verbose                          = false,
){
  include brocadevtm
  $ip   = $brocadevtm::rest_ip
  $port = $brocadevtm::rest_port
  $user = $brocadevtm::rest_user
  $pass = $brocadevtm::rest_pass

  info ("Configuring global_settings ${name}")
  vtmrest { "global_settings":
    endpoint => "https://${ip}:${port}/api/tm/3.3/config/active",
    ensure => $ensure,
    username => $user,
    password => $pass,
    type => 'application/json',
    content => template('brocadevtm/global_settings.erb'),
    internal => 'global_settings',
    debug => 0,
  }
}
