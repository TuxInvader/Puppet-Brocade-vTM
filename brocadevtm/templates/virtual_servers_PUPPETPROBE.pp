# === Define: brocadevtm::virtual_servers_PUPPETPROBE
#

define brocadevtm::virtual_servers_PUPPETPROBE (
  $ensure,
  $basic__add_cluster_ip                   = true,
  $basic__add_x_forwarded_for              = false,
  $basic__add_x_forwarded_proto            = false,
  $basic__bandwidth_class                  = "",
  $basic__close_with_rst                   = false,
  $basic__completionrules                  = [],
  $basic__connect_timeout                  = 10,
  $basic__enabled                          = false,
  $basic__ftp_force_server_secure          = true,
  $basic__glb_services                     = [],
  $basic__listen_on_any                    = true,
  $basic__listen_on_hosts                  = [],
  $basic__listen_on_traffic_ips            = [],
  $basic__note                             = "",
  $basic__pool                             = "PUPPETPROBE",
  $basic__port                             = 80,
  $basic__protection_class                 = "",
  $basic__protocol                         = "http",
  $basic__request_rules                    = [],
  $basic__response_rules                   = [],
  $basic__slm_class                        = "",
  $basic__so_nagle                         = false,
  $basic__ssl_client_cert_headers          = "none",
  $basic__ssl_decrypt                      = false,
  $basic__ssl_honor_fallback_scsv          = "use_default",
  $aptimizer__enabled                      = false,
  $aptimizer__profile                      = [],
  $connection__keepalive                   = true,
  $connection__keepalive_timeout           = 10,
  $connection__max_client_buffer           = 65536,
  $connection__max_server_buffer           = 65536,
  $connection__max_transaction_duration    = 0,
  $connection__server_first_banner         = "",
  $connection__timeout                     = 300,
  $connection_errors__error_file           = "Default",
  $cookie__domain                          = "no_rewrite",
  $cookie__new_domain                      = "",
  $cookie__path_regex                      = "",
  $cookie__path_replace                    = "",
  $cookie__secure                          = "no_modify",
  $dns__edns_udpsize                       = 4096,
  $dns__max_udpsize                        = 4096,
  $dns__verbose                            = false,
  $dns__zones                              = [],
  $ftp__data_source_port                   = 0,
  $ftp__force_client_secure                = true,
  $ftp__port_range_high                    = 0,
  $ftp__port_range_low                     = 0,
  $ftp__ssl_data                           = true,
  $gzip__compress_level                    = 1,
  $gzip__enabled                           = false,
  $gzip__include_mime                      = ["text/html", "text/plain"],
  $gzip__max_size                          = 10000000,
  $gzip__min_size                          = 1000,
  $gzip__no_size                           = true,
  $http__chunk_overhead_forwarding         = "lazy",
  $http__location_regex                    = "",
  $http__location_replace                  = "",
  $http__location_rewrite                  = "if_host_matches",
  $http__mime_default                      = "text/plain",
  $http__mime_detect                       = false,
  $kerberos_protocol_transition__enabled   = false,
  $kerberos_protocol_transition__principal = "",
  $kerberos_protocol_transition__target    = "",
  $log__client_connection_failures         = false,
  $log__enabled                            = false,
  $log__filename                           = "%zeushome%/zxtm/log/%v.log",
  $log__format                             = "%h %l %u %t \\\"%r\\\" %s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"",
  $log__save_all                           = true,
  $log__server_connection_failures         = false,
  $log__session_persistence_verbose        = false,
  $log__ssl_failures                       = false,
  $recent_connections__enabled             = true,
  $recent_connections__save_all            = false,
  $request_tracing__enabled                = false,
  $request_tracing__trace_io               = false,
  $rtsp__streaming_port_range_high         = 0,
  $rtsp__streaming_port_range_low          = 0,
  $rtsp__streaming_timeout                 = 30,
  $sip__dangerous_requests                 = "node",
  $sip__follow_route                       = true,
  $sip__max_connection_mem                 = 65536,
  $sip__mode                               = "sip_gateway",
  $sip__rewrite_uri                        = false,
  $sip__streaming_port_range_high          = 0,
  $sip__streaming_port_range_low           = 0,
  $sip__streaming_timeout                  = 60,
  $sip__timeout_messages                   = true,
  $sip__transaction_timeout                = 30,
  $smtp__expect_starttls                   = true,
  $ssl__add_http_headers                   = false,
  $ssl__client_cert_cas                    = [],
  $ssl__issued_certs_never_expire          = [],
  $ssl__ocsp_enable                        = false,
  $ssl__ocsp_issuers                       = [],
  $ssl__ocsp_max_response_age              = 0,
  $ssl__ocsp_stapling                      = false,
  $ssl__ocsp_time_tolerance                = 30,
  $ssl__ocsp_timeout                       = 10,
  $ssl__prefer_sslv3                       = false,
  $ssl__request_client_cert                = "dont_request",
  $ssl__send_close_alerts                  = true,
  $ssl__server_cert_default                = "",
  $ssl__server_cert_host_mapping           = [],
  $ssl__signature_algorithms               = "",
  $ssl__ssl_ciphers                        = "",
  $ssl__ssl_support_ssl2                   = "use_default",
  $ssl__ssl_support_ssl3                   = "use_default",
  $ssl__ssl_support_tls1                   = "use_default",
  $ssl__ssl_support_tls1_1                 = "use_default",
  $ssl__ssl_support_tls1_2                 = "use_default",
  $ssl__trust_magic                        = false,
  $syslog__enabled                         = false,
  $syslog__format                          = "%h %l %u %t \\\"%r\\\" %s %b \\\"%{Referer}i\\\" \\\"%{User-agent}i\\\"",
  $syslog__ip_end_point                    = "",
  $syslog__msg_len_limit                   = 1024,
  $tcp__proxy_close                        = false,
  $udp__end_point_persistence              = true,
  $udp__port_smp                           = false,
  $udp__response_datagrams_expected        = 1,
  $udp__timeout                            = 7,
  $web_cache__control_out                  = "",
  $web_cache__enabled                      = false,
  $web_cache__error_page_time              = 30,
  $web_cache__max_time                     = 600,
  $web_cache__refresh_time                 = 2,
){
  include brocadevtm
  $ip   = $brocadevtm::rest_ip
  $port = $brocadevtm::rest_port
  $user = $brocadevtm::rest_user
  $pass = $brocadevtm::rest_pass

  info ("Configuring virtual_servers_PUPPETPROBE ${name}")
  vtmrest { "virtual_servers/PUPPETPROBE/${name}":
    endpoint => "https://${ip}:${port}/api/tm/3.3/config/active",
    ensure => $ensure,
    username => $user,
    password => $pass,
    type => 'application/json',
    content => template('brocadevtm/virtual_servers_PUPPETPROBE.erb'),
    debug => 0,
  }
}
